<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Product Collection</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Product Collection</h1>
        <nav>
            <ul>
                <li><a href="#dairy">Dairy & Cold Storage</a></li>
                <li><a href="#bread">Bread & Cakes</a></li>
                <li><a href="#meat">Meat & Fish</a></li>
            </ul>
        </nav>
        <div class="search-bar">
            <input type="text" id="search" placeholder="Search products...">
        </div>
    </header>

    <main>
        <section id="products">
            <h2>Our Products</h2>
            <div id="product-grid" class="product-grid">
                <!-- Products will be dynamically loaded here -->
            </div>
        </section>
    </main>

    <footer>
        <p>Contact us at info@productcollection.com | Follow us on Social Media</p>
    </footer>

    <!-- Modal for Product Details -->
    <div id="product-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <img id="modal-img" src="" alt="Product Image">
            <h2 id="modal-title"></h2>
            <p id="modal-category"></p>
            <p id="modal-code"></p>
            <p id="modal-desc"></p>
        </div>
    </div>

    <script>
        // Fetch the JSON file and load the data into the page
        fetch('database_data.json')
        .then(response => response.json())
        .then(data => {
            const productGrid = document.getElementById('product-grid');
            const searchInput = document.getElementById('search');

            // Function to render products
            const renderProducts = (products) => {
                productGrid.innerHTML = ''; // Clear previous content
                products.forEach(product => {
                    const productDiv = document.createElement('div');
                    productDiv.classList.add('product');

                    const productImage = document.createElement('img');
                    productImage.src = product[4] || 'placeholder.jpg'; // Default if image is null
                    productImage.alt = product[1];

                    const productTitle = document.createElement('h3');
                    productTitle.textContent = product[1];

                    const productCategory = document.createElement('p');
                    productCategory.textContent = product[2];

                    const productCode = document.createElement('p');
                    productCode.textContent = `Product Code: ${product[0]}`;

                    // Modal trigger
                    productDiv.addEventListener('click', () => openModal(product));

                    // Append to the grid
                    productDiv.appendChild(productImage);
                    productDiv.appendChild(productTitle);
                    productDiv.appendChild(productCategory);
                    productDiv.appendChild(productCode);
                    productGrid.appendChild(productDiv);
                });
            };

            // Function to open product modal
            const openModal = (product) => {
                document.getElementById('modal-img').src = product[4] || 'placeholder.jpg';
                document.getElementById('modal-title').textContent = product[1];
                document.getElementById('modal-category').textContent = `Category: ${product[2]}`;
                document.getElementById('modal-code').textContent = `Product Code: ${product[0]}`;
                document.getElementById('modal-desc').textContent = product[3] || 'No description available.';
                document.getElementById('product-modal').style.display = 'block';
            };

            // Close modal
            const closeModal = () => {
                document.getElementById('product-modal').style.display = 'none';
            };

            document.querySelector('.close').addEventListener('click', closeModal);
            window.addEventListener('click', (e) => {
                if (e.target == document.getElementById('product-modal')) closeModal();
            });

            // Filtering functionality
            searchInput.addEventListener('input', (event) => {
                const searchValue = event.target.value.toLowerCase();
                const filteredProducts = data.products.filter(product =>
                    product[1].toLowerCase().includes(searchValue) || product[2].toLowerCase().includes(searchValue)
                );
                renderProducts(filteredProducts);
            });

            // Initial render of products
            renderProducts(data.products);
        })
        .catch(error => {
            console.error('Error loading the product data:', error);
        });
    </script>
</body>
</html>
